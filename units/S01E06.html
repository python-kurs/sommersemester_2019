<!DOCTYPE html>
<html lang="en">
  

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Remote Sensing I</title>
  <meta name="description" content="">

  <link rel="canonical" href="https://python-kurs.github.io/sommersemester_2019//units/S01E06.html">
  <link rel="alternate" type="application/rss+xml" title="Sommersemester 2019" href="https://python-kurs.github.io/sommersemester_2019//feed.xml">

  <meta property="og:url"         content="https://python-kurs.github.io/sommersemester_2019//units/S01E06.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Remote Sensing I" />
<meta property="og:description" content="" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "https://python-kurs.github.io/sommersemester_2019//units/S01E06.html",
  "headline":
    "Remote Sensing I",
  "datePublished":
    "2019-06-12T11:47:16+00:00",
  "dateModified":
    "2019-06-12T11:47:16+00:00",
  "description":
    "",
  "author": {
    "@type": "Person",
    "name": "Sebastian Egli, Benjamin Rösner"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://python-kurs.github.io/sommersemester_2019/",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://python-kurs.github.io/sommersemester_2019/",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/sommersemester_2019/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/sommersemester_2019/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

// Helper function to init things quickly
initFunction = function(myfunc) {
  runWhenDOMLoaded(myfunc);
  document.addEventListener('turbolinks:load', myfunc);
};
</script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/sommersemester_2019/';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="/sommersemester_2019/assets/js/anchor.min.js"  type="text/javascript"></script>
  <script>

initFunction(function () {
    anchors.add("main h1, main h2, main h3, main h4")
});

</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/sommersemester_2019/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->

<script type="text/x-thebe-config">
    {
      requestKernel: true,
      binderOptions: {
        repo: 'YOUR-ORG/YOUR-REPO',
        ref: 'master',
      },
      kernelOptions: {
        name: 'python3',
      }
    }
</script>
<script src="https://unpkg.com/thebelab@0.3.3/lib/index.js"></script>
<script>
    /**
     * Add attributes to Thebelab blocks
     */

    const initThebelab = () => {
        const addThebelabToCodeCells = () => {
            console.log("Adding thebelab to code cells...");
            // If Thebelab hasn't loaded, wait a bit and try again. This
            // happens because we load ClipboardJS asynchronously.
            if (window.thebelab === undefined) {
                setTimeout(addThebelabToCodeCells, 250)
            return
            }

            // If we already detect a Thebelab cell, don't re-run
            if (document.querySelectorAll('div.thebelab-cell').length > 0) {
                return;
            }

            // Find all code cells, replace with Thebelab interactive code cells
            const codeCells = document.querySelectorAll('.input_area pre')
            codeCells.forEach((codeCell, index) => {
                const id = codeCellId(index)
                codeCell.setAttribute('data-executable', 'true')

                // Figure out the language it uses and add this too
                var parentDiv = codeCell.parentElement.parentElement;
                var arrayLength = parentDiv.classList.length;
                for (var ii = 0; ii < arrayLength; ii++) {
                    var parts = parentDiv.classList[ii].split('language-');
                    if (parts.length === 2) {
                        // If found, assign dataLanguage and break the loop
                        var dataLanguage = parts[1];
                        break;
                    }
                }
                codeCell.setAttribute('data-language', dataLanguage)

                // If the code cell is hidden, show it
                var inputCheckbox = document.querySelector(`input#hidebtn${codeCell.id}`);
                if (inputCheckbox !== null) {
                    setCodeCellVisibility(inputCheckbox, 'visible');
                }
            });

            // Remove the event listener from the page so keyboard press doesn't
            // Change page
            document.removeEventListener('keydown', initPageNav)
            keyboardListener = false;

            // Init thebelab
            thebelab.bootstrap();

            // Remove copy buttons since they won't work anymore
            const copyButtons = document.querySelectorAll('.copybtn')
            copyButtons.forEach((copyButton, index) => {
                copyButton.remove();
            });

            // Remove outputs since they'll be stale
            const outputs = document.querySelectorAll('.output *, .output')
            outputs.forEach((output, index) => {
                output.remove();
            });
        }

        // Add event listener for the function to modify code cells
        const thebelabButton = document.getElementById('interact-button-thebelab');
        if (thebelabButton === null) {
            setTimeout(initThebelab, 250)
        return
        };
        thebelabButton.addEventListener('click', addThebelabToCodeCells);
    }

    // Initialize Thebelab
    initFunction(initThebelab);
</script>


  <!-- Google analytics -->
  <script src="/sommersemester_2019/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load JS that depends on site variables -->
  <script>
/**
 * Set up copy/paste for code blocks
 */
const codeCellId = index => `codecell${index}`

const clipboardButton = id =>
  `<a class="btn copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#${id}">
    <img src="/sommersemester_2019/assets/images/copy-button.svg" alt="Copy to clipboard">
  </a>`

// Clears selected text since ClipboardJS will select the text when copying
const clearSelection = () => {
  if (window.getSelection) {
    window.getSelection().removeAllRanges()
  } else if (document.selection) {
    document.selection.empty()
  }
}

// Changes tooltip text for two seconds, then changes it back
const temporarilyChangeTooltip = (el, newText) => {
  const oldText = el.getAttribute('data-tooltip')
  el.setAttribute('data-tooltip', newText)
  setTimeout(() => el.setAttribute('data-tooltip', oldText), 2000)
}

const addCopyButtonToCodeCells = () => {
  // If ClipboardJS hasn't loaded, wait a bit and try again. This
  // happens because we load ClipboardJS asynchronously.
  if (window.ClipboardJS === undefined) {
    setTimeout(addCopyButtonToCodeCells, 250)
    return
  }

  const codeCells = document.querySelectorAll('div.highlighter-rouge:not(.output) pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.querySelector(`pre#${id} + a`) == null) {
      codeCell.insertAdjacentHTML('afterend', clipboardButton(id));
    }
  })

  const clipboard = new ClipboardJS('.copybtn')
  clipboard.on('success', event => {
    clearSelection()
    temporarilyChangeTooltip(event.trigger, 'Copied!')
  })

  clipboard.on('error', event => {
    temporarilyChangeTooltip(event.trigger, 'Failed to copy')
  })

  // Get rid of clipboard before the next page visit to avoid memory leak
  document.addEventListener('turbolinks:before-visit', () =>
    clipboard.destroy()
  )
}

initFunction(addCopyButtonToCodeCells);
</script>

  <!-- Hide cell code -->
  
<script>
/**
Add buttons to hide code cells
*/


var setCodeCellVisibility = function(inputField, kind) {
    // Update the image and class for hidden
    var id = inputField.getAttribute('data-id');
    var codeCell = document.querySelector(`#${id}`);

    if (kind === "visible") {
        codeCell.classList.remove('hidden');
        inputField.checked = true;
    } else {
        codeCell.classList.add('hidden');
        inputField.checked = false;
    }
}

var toggleCodeCellVisibility = function (event) {
    // The label is clicked, and now we decide what to do based on the input field's clicked status
    if (event.target.tagName === "LABEL") {
        var inputField = event.target.previousElementSibling;
    } else {
        // It is the span inside the target
        var inputField = event.target.parentElement.previousElementSibling;
    }

    if (inputField.checked === true) {
        setCodeCellVisibility(inputField, "visible");
    } else {
        setCodeCellVisibility(inputField, "hidden");
    }
}


// Button constructor
const hideCodeButton = id => `<input class="hidebtn" type="checkbox" id="hidebtn${id}" data-id="${id}"><label title="Toggle cell" for="hidebtn${id}" class="plusminus"><span class="pm_h"></span><span class="pm_v"></span></label>`

var addHideButton = function () {
  // If a hide button is already added, don't add another
  if (document.querySelector('div.hidecode input') !== null) {
      return;
  }

  // Find the input cells and add a hide button
  document.querySelectorAll('div.input_area div.highlight').forEach(function (item, index) {
    if (!item.parentElement.classList.contains("hidecode")) {
        // Skip the cell if it doesn't have a hidecode class
        return;
    }

    const id = codeCellId(index)
    item.setAttribute('id', id);
    item.insertAdjacentHTML('afterend', hideCodeButton(id))

    // Set up the visibility toggle
    hideLink = document.querySelector(`#${id} + input + label`);
    hideLink.addEventListener('click', toggleCodeCellVisibility)
  });
}


// Initialize the hide buttos
var initHiddenCells = function () {
    // Add hide buttons to the cells
    addHideButton();

    // Toggle the code cells that should be hidden
    document.querySelectorAll('div.hidecode input').forEach(function (item) {
        setCodeCellVisibility(item, 'hidden');
        item.checked = true;
    })
}

initFunction(initHiddenCells);

</script>


  <!-- Load custom website scripts -->
  <script src="/sommersemester_2019/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/sommersemester_2019/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/sommersemester_2019/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  

  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="/sommersemester_2019/assets/js/lunr/lunr.min.js" type="text/javascript"></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>
</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://python-kurs.github.io/sommersemester_2019/intro.html"><img src="/sommersemester_2019/images/logo/logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">Sommersemester 2019</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/sommersemester_2019/intro.html"
        >
          
          Introduction
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/sommersemester_2019/motivation.html"
        >
          
          Motivation
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/sommersemester_2019/about.html"
        >
          
          About
        </a>

        
      </li>

      
    
      
      
        <li class="c-sidebar__chapter"><a class="c-sidebar__entry" href="/sommersemester_2019/search.html">Search</a></li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/sommersemester_2019/units/units.html"
        >
          
          Sessions
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/sommersemester_2019/units/S01E01.html"
                >
                  
                  Python Basics I
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/sommersemester_2019/units/S01E02.html"
                >
                  
                  Python Basics II
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/sommersemester_2019/units/S01E03.html"
                >
                  
                  Python Basics III
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/sommersemester_2019/units/S01E04.html"
                >
                  
                  Data science I
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/sommersemester_2019/units/S01E05.html"
                >
                  
                  Data science II
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/sommersemester_2019/units/S01E06.html"
                >
                  
                  Remote Sensing I
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/sommersemester_2019/solutions/solutions.html"
        >
          
          Solutions
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/sommersemester_2019/solutions/exercise-1/Exercise-1_Solutions.html"
                >
                  
                  Exercise I
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/sommersemester_2019/solutions/exercise-2/Exercise-2_Solutions.html"
                >
                  
                  Exercise II
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/sommersemester_2019/solutions/exercise-3/Exercise-3_Solutions.html"
                >
                  
                  Exercise III
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/sommersemester_2019/solutions/exercise-4/Exercise-4_Solutions.html"
                >
                  
                  Exercise IV
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/sommersemester_2019/allgemeine_hinweise.html"
        >
          
          Allgemeine Hinweise
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/sommersemester_2019/results.html"
        >
          
          Results
        </a>

        
      </li>

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a></p>
</nav>

      
      <!-- Shamelessly copied from minimal mistakes -->


<!-- TOC will only show up if it has at least one item -->


  <aside class="sidebar__right">
    <nav class="onthispage">
      <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
      <ul class="toc__menu">
  <li><a href="#satpy">SatPy</a></li>
  <li><a href="#load--view-msg-data">Load &amp; view MSG data</a>
    <ul>
      <li><a href="#calibration">Calibration</a></li>
      <li><a href="#coordinates">Coordinates</a></li>
    </ul>
  </li>
  <li><a href="#composites">Composites</a>
    <ul>
      <li><a href="#built-in-composites">Built-in composites</a></li>
      <li><a href="#user-defined-composites">User-defined composites</a></li>
    </ul>
  </li>
  <li><a href="#cropping">Cropping</a></li>
  <li><a href="#resampling">Resampling</a></li>
</ul>
    </nav>
  </aside>


      
      <main class="c-textbook__page" tabindex="-1">
          <div class="o-wrapper">
            <div class="c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

            
<div class="buttons">
<a href="/sommersemester_2019/content/units/S01E06.ipynb" download>
<button id="interact-button-download" class="interact-button">Download</button>
</a>

<button id="interact-button-thebelab" class="interact-button">Interact</button>




</div>


            <div class="c-textbook__content">
              
<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <h1 id="remote-sensing-i">Remote Sensing I</h1>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <h2 id="satpy">SatPy</h2>

  <p>A Python Library for Weather Satellite Processing</p>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>From the <a href="https://satpy.readthedocs.io/en/latest/index.html">documentation</a>:</p>

  <p>SatPy is a python library for <strong>reading</strong> and <strong>manipulating</strong> meteorological remote sensing data and <strong>writing</strong> it to various image and data file formats.</p>

  <p>SatPy comes with the ability to make various <strong>RGB composites</strong> directly from satellite instrument channel data or higher level processing output.</p>

  <p>The pyresample package is used to <strong>resample data</strong> to different uniform areas or grids.</p>

  <p>Various <strong>atmospheric corrections</strong> and <strong>visual enhancements</strong> are also provided, either directly in Satpy or from those in the PySpectral and TrollImage packages.</p>

</div>

<div class="markdown_area ">
  <!--<div class="warning ">
</div>-->

  <div class="alert warning">

    <p>Unfortunately, the EUMETSAT is currently repeatedly changing its MSG data formats and SatPy has trouble following these changes.</p>

    <p>The latest changes in the MSG data format were already adapted in the SatPy scripts (12.06.2019) but these changes did not yet make it into the conda packaging system. So we have to use pip to get the newest SatPy version:</p>

    <ol>
      <li>Uninstall satpy using conda: <code class="highlighter-rouge">conda uninstall satpy</code></li>
      <li>Reinstall satpy using pip:   <code class="highlighter-rouge">pip install satpy</code></li>
    </ol>

  </div>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <h2 id="load--view-msg-data">Load &amp; view MSG data</h2>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>SatPy is well suited for working with data of Meteosat Second Generation Satellites:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">satpy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>First, we specify the file(s) of the scene we want to open together with the reader of the respective file type (in our case we use the netcdf reader for the SEVIRI instrument):</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dateien</span> <span class="o">=</span> <span class="p">[</span><span class="s">"../data/W_XX-EUMETSAT-Darmstadt,VIS+IR+HRV+IMAGERY,MSG1+SEVIRI_C_EUMG_20060117120009.nc"</span><span class="p">]</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s">'seviri_l1b_nc'</span> <span class="p">:</span> <span class="n">dateien</span><span class="p">}</span>
</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>Then we instantiate a Scene object with the given files:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scn</span> <span class="o">=</span> <span class="n">satpy</span><span class="o">.</span><span class="n">Scene</span><span class="p">(</span><span class="n">filenames</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>The scene attributes tell us what instrument we are dealing with and the start- and end-times of the scene scan:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scn</span><span class="o">.</span><span class="n">attrs</span>
</code></pre></div></div>

<div class="output output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'sensor': {'seviri'},
 'start_time': datetime.datetime(2006, 1, 17, 12, 0, 9, 427000),
 'end_time': datetime.datetime(2006, 1, 17, 12, 15, 9, 137000)}
</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>To get an overview of all available datasets (=channels/bands) of the scene, we can call the <code class="highlighter-rouge">all_dataset_names()</code> function:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scn</span><span class="o">.</span><span class="n">all_dataset_names</span><span class="p">()</span>
</code></pre></div></div>

<div class="output output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['HRV',
 'IR_016',
 'IR_039',
 'IR_087',
 'IR_097',
 'IR_108',
 'IR_120',
 'IR_134',
 'VIS006',
 'VIS008',
 'WV_062',
 'WV_073']
</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="info ">
</div>-->

  <div class="alert info">

    <p>To be precise, <code class="highlighter-rouge">scn.all_dataset_names()</code> lists all data sets which the respective reader is able to load from the scene file. However, if any of these data sets are missing in the scene file, they consequently also cannot be loaded, although they are listed by this method.</p>

  </div>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>Before we are able to work with the datasets, we first have to load the bands we are actually interested in. Let’s say, we are only interested in the visible wavelength at 0.6µm:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scn</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="s">"VIS006"</span><span class="p">])</span> <span class="c"># Note that we have to pass a list to the load function, even if we only want to work with one band.</span>
</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="info ">
</div>-->

  <div class="alert info">

    <p>You can also load bands by passing the specific wavelength you are interested in, e.g.:</p>

    <pre><code class="language-Python">scn.load([12.5])
</code></pre>

    <p>which, in this case, would load the band “IR_120” which covers the wavelength region from 11.0µm to 13.0µm.</p>

  </div>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>We can have a look at all loaded bands by printing out the keys:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scn</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</code></pre></div></div>

<div class="output output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[DatasetID(name='VIS006', wavelength=(0.56, 0.635, 0.71), resolution=3000.403165817, polarization=None, calibration='reflectance', level=None, modifiers=())]
</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>Let’s have a first look at what we are dealing with:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scn</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s">"VIS006"</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../images/units/S01E06_22_0.png" alt="png" /></p>

<div class="markdown_area ">
  <!--<div class="task ">
</div>-->

  <div class="alert task">

    <p><strong>Task</strong></p>

    <ol>
      <li>Download the MSG data at https://box.uni-marburg.de/index.php/s/pXhB2Tw4k6ymk4i</li>
      <li>Read the data set with satpy and create a Scene object</li>
      <li>Plot the bands at 0.6μm and at 6.2μm.</li>
      <li>Why can you see the full disk only at 6.2μm?</li>
    </ol>

  </div>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>Ok, thats nice :)</p>

  <p>However, SatPy’s <code class="highlighter-rouge">show()</code> function doesn’t offer the option to depict a colorbar (so that we get an impression of the value range of the depicted colors).</p>

  <p>Fortunately, we can easily achieve this by using the <code class="highlighter-rouge">imshow()</code> or <code class="highlighter-rouge">pcolormesh()</code> functions from xarray (which are just thin wrappers around the same-named matplotlib functions). For most of our use-cases it’s better to use <code class="highlighter-rouge">imshow()</code> as it is much faster when we are dealing with large data sets.</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scn</span><span class="p">[</span><span class="s">"VIS006"</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">()</span>
</code></pre></div></div>

<div class="output output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.image.AxesImage at 0x7f48541f6f98&gt;
</code></pre></div></div>

<p class="output output_png"><img src="../images/units/S01E06_26_1.png" alt="png" /></p>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>Well, this is rahter ugly and the colorbar title is misleading (although that’s not xarray’s fault).</p>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>Like always, if we want to control specific plot elements, we can just use matplotlib itself. 
We need more lines of code with this approach but the result looks better:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">scn</span><span class="p">[</span><span class="s">"VIS006"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s">"Greys_r"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">fraction</span><span class="o">=.</span><span class="mo">04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p class="output output_png"><img src="../images/units/S01E06_29_0.png" alt="png" /></p>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>It seems as if we are dealing with reflectance values here (range goes from 0% to 100%). Let’s go sure…</p>

  <p>To get an overview of the metadata of a loaded band, you can just use the <code class="highlighter-rouge">print()</code> function on the band:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">scn</span><span class="p">[</span><span class="s">"VIS006"</span><span class="p">])</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;xarray.DataArray 'ch1' (y: 3712, x: 3712)&gt;
dask.array&lt;shape=(3712, 3712), dtype=float32, chunksize=(3712, 3712)&gt;
Coordinates:
    lat      (y, x) float32 dask.array&lt;shape=(3712, 3712), chunksize=(3712, 3712)&gt;
    lon      (y, x) float32 dask.array&lt;shape=(3712, 3712), chunksize=(3712, 3712)&gt;
  * x        (x) float64 -5.567e+06 -5.564e+06 ... 5.564e+06 5.567e+06
  * y        (y) float64 5.567e+06 5.564e+06 5.561e+06 ... -5.564e+06 -5.567e+06
Attributes:
    standard_name:        toa_bidirectional_reflectance
    file_type:            nc_seviri_l1b
    resolution:           3000.403165817
    long_name:            SEVIRI visible 0.6 micron pixel counts
    polarization:         None
    modifiers:            ()
    sensor:               seviri
    valid_min:            0
    calibration:          reflectance
    comment:              Radiance in mW m-2 sr-1(cm-1)-1 = add_offset + ( pi...
    scale_factor:         0.023120637983083725
    add_offset:           -1.17915253713727
    valid_max:            1023
    units:                %
    level:                None
    platform_name:        Meteosat-8
    name:                 VIS006
    nc_key:               ch1
    wavelength:           (0.56, 0.635, 0.71)
    start_time:           2006-01-17 12:00:09.427000
    end_time:             2006-01-17 12:15:09.137000
    area:                 Area ID: some_area_name\nDescription: On-the-fly ar...
    ancillary_variables:  []

</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>This shows us some valuable information about the data:</p>

  <ul>
    <li>The data is stored within an <code class="highlighter-rouge">xarray.DataArray</code> (which itself uses a <code class="highlighter-rouge">dask.array</code> to store the sensor data)</li>
    <li>The band has 2 dimensions x and y (it is an image)</li>
    <li>Over both dimensions, the image spreads over 3712 pixels</li>
    <li>Pixel values are stored as float32</li>
    <li>Values are already converted to “reflectance” between 0% and 100%. So SatPy already converted the original raw counts to reflectance values.</li>
    <li>And a lot more (like satellite and sensor name, resolution, …)</li>
  </ul>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <h3 id="calibration">Calibration</h3>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>By default Satpy will provide the version of the dataset with the highest resolution and the highest level of calibration (brightness temperature or reflectance over radiance). It is also possible to request one or more of these exact versions of a dataset by specifying the calibration argument of the <code class="highlighter-rouge">load()</code> function:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># This loads the band at 10.8μm as radiances (in mW m-2 sr-1(cm-1)-1):</span>
<span class="n">scn</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="mf">10.8</span><span class="p">],</span> <span class="n">calibration</span><span class="o">=</span><span class="p">[</span><span class="s">'radiance'</span><span class="p">])</span>

<span class="c"># This loads the band at 10.8μm as brightness temperatures (in K):</span>
<span class="n">scn</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="mf">10.8</span><span class="p">],</span> <span class="n">calibration</span><span class="o">=</span><span class="p">[</span><span class="s">'brightness_temperature'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">im1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">scn</span><span class="p">[</span><span class="n">scn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s">"Greys_r"</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">scn</span><span class="p">[</span><span class="n">scn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s">"Greys_r"</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"10.8μm Brightness temperature"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"10.8μm Radiance"</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=.</span><span class="mo">05</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=.</span><span class="mo">05</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p class="output output_png"><img src="../images/units/S01E06_36_0.png" alt="png" /></p>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <h3 id="coordinates">Coordinates</h3>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>Let’s go back to the visible band at 0.6μm: From the metadata above, we can also derive that there is coordinate information provided with the data:</p>

  <p><code class="highlighter-rouge">lat</code> and <code class="highlighter-rouge">lon</code> are coordinate variables, each consisting of a full 3712x3712 layer, spanning along the dimensions <code class="highlighter-rouge">x</code> and <code class="highlighter-rouge">y</code>.</p>

  <p>We can have a closer look at the coordinate layers by printing them to the console:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scn</span><span class="p">[</span><span class="s">"VIS006"</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span>
</code></pre></div></div>

<div class="output output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;xarray.DataArray 'lat' (y: 3712, x: 3712)&gt;
dask.array&lt;shape=(3712, 3712), dtype=float32, chunksize=(3712, 3712)&gt;
Coordinates:
    lat      (y, x) float32 dask.array&lt;shape=(3712, 3712), chunksize=(3712, 3712)&gt;
    lon      (y, x) float32 dask.array&lt;shape=(3712, 3712), chunksize=(3712, 3712)&gt;
  * x        (x) float64 -5.567e+06 -5.564e+06 ... 5.564e+06 5.567e+06
  * y        (y) float64 5.567e+06 5.564e+06 5.561e+06 ... -5.564e+06 -5.567e+06
Attributes:
    missing_value:        -999.0
    _CoordinateAxisType:  Lat
    valid_max:            90.0
    long_name:            Latitudes for each pixel count
    standard_name:        latitude
    valid_min:            -90.0
    units:                degrees_north
</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>So here we see, that <code class="highlighter-rouge">lat</code> is given in units of “degrees_north” and that valid values are between -90° and +90°.</p>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>For the sake of completeness we can also plot the coordinate layers:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">im1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">scn</span><span class="p">[</span><span class="s">"VIS006"</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s">"jet"</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">90</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">scn</span><span class="p">[</span><span class="s">"VIS006"</span><span class="p">]</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s">"jet"</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">90</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"lon"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"lat"</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=.</span><span class="mo">05</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=.</span><span class="mo">05</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p class="output output_png"><img src="../images/units/S01E06_42_0.png" alt="png" /></p>

<div class="markdown_area ">
  <!--<div class="task ">
</div>-->

  <div class="alert task">

    <p><strong>Quick question:</strong></p>

    <ol>
      <li>Why are <code class="highlighter-rouge">lat</code> and <code class="highlighter-rouge">lon</code> provided as 2-dimensional data? (and not 1-dimensional)</li>
      <li>What do the values of dimensions <code class="highlighter-rouge">x</code> and <code class="highlighter-rouge">y</code> mean?</li>
    </ol>

  </div>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <h2 id="composites">Composites</h2>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <h3 id="built-in-composites">Built-in composites</h3>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>SatPy comes with many built-in utility functions to create composite images of the data.</p>

  <p>To get an overview of all available composites, you can do:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scn</span><span class="o">.</span><span class="n">available_composite_names</span><span class="p">()</span>
</code></pre></div></div>

<div class="output output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['airmass',
 'ash',
 'cloudtop',
 'cloudtop_daytime',
 'colorized_ir_clouds',
 'convection',
 'day_microphysics',
 'day_microphysics_winter',
 'dust',
 'fog',
 'green_snow',
 'ir108_3d',
 'ir_cloud_day',
 'ir_overview',
 'ir_sandwich',
 'natural_color',
 'natural_color_sun',
 'night_fog',
 'night_microphysics',
 'overview',
 'overview_sun',
 'realistic_colors',
 'snow',
 'vis_sharpened_ir']
</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>As with the single bands, you have to load a composite into the Scene object first, if you want to work with it:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scn</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="s">"natural_color"</span><span class="p">])</span>
<span class="n">scn</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s">"natural_color"</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../images/units/S01E06_50_0.png" alt="png" /></p>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>Let’s have a look at the metadata of the composite:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">scn</span><span class="p">[</span><span class="s">"natural_color"</span><span class="p">])</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;xarray.DataArray 'where-3d991db57e1d0ca002dc86117290e728' (bands: 3, y: 3712, x: 3712)&gt;
dask.array&lt;shape=(3, 3712, 3712), dtype=float32, chunksize=(1, 3712, 3712)&gt;
Coordinates:
    lat      (y, x) float32 -999.0 -999.0 -999.0 -999.0 ... -999.0 -999.0 -999.0
    lon      (y, x) float32 -999.0 -999.0 -999.0 -999.0 ... -999.0 -999.0 -999.0
  * x        (x) float64 -5.567e+06 -5.564e+06 ... 5.564e+06 5.567e+06
  * y        (y) float64 5.567e+06 5.564e+06 5.561e+06 ... -5.564e+06 -5.567e+06
  * bands    (bands) &lt;U1 'R' 'G' 'B'
Attributes:
    standard_name:           natural_color
    file_type:               nc_seviri_l1b
    resolution:              None
    polarization:            None
    ancillary_variables:     []
    sensor:                  seviri
    valid_min:               0
    area:                    Area ID: some_area_name\nDescription: On-the-fly...
    comment:                 Radiance in mW m-2 sr-1(cm-1)-1 = add_offset + (...
    valid_max:               1023
    level:                   None
    platform_name:           Meteosat-8
    end_time:                2006-01-17 12:15:09.137000
    start_time:              2006-01-17 12:00:09.427000
    wavelength:              None
    optional_datasets:       []
    name:                    natural_color
    prerequisites:           ['IR_016', 'VIS008', 'VIS006']
    optional_prerequisites:  []
    calibration:             None
    modifiers:               None
    mode:                    RGB

</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <ul>
    <li>We see, that the composite consists of 3 bands, stored in a dask-array with the shape (3, 3712, 3712)</li>
    <li>Each band has 2 dimensions x and y</li>
    <li>Over both dimensions, the images spread over 3712 pixels</li>
    <li>Pixel values are stored as float32</li>
    <li>We also see, that the 3 bands correspond to the red, green and blue layers of the image that we plottetd above.</li>
    <li>These bands are: IR_016, VIS008 and VIS006 (prerequisites)</li>
  </ul>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>Guides on how to interpret these composites can be found on the Eumetsat website:</p>

  <p>https://www.eumetsat.int/website/home/Data/Training/TrainingLibrary/DAT_2044069.html</p>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>Let’s load all available bands (except HRV) and the natural color composite so we can work with these data sets later on:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scn</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">scn</span><span class="o">.</span><span class="n">all_dataset_names</span><span class="p">()[</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">scn</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="s">"natural_color"</span><span class="p">])</span>
</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="task ">
</div>-->

  <div class="alert task">

    <p><strong>Task</strong></p>

    <p>Plot a composite that is useful for interpreting the microphysical properties of clouds at daytime using the 06:00 UTC scene.</p>

  </div>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <h3 id="user-defined-composites">User-defined composites</h3>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>Additionally to the many built-in composites, you can define your own composites using the Compositer classes of SatPy.</p>

  <p>Let’s create an infrared overview using the bands at 3.9μm, 10.8μm and 12.0μm:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">compositor</span> <span class="o">=</span> <span class="n">satpy</span><span class="o">.</span><span class="n">composites</span><span class="o">.</span><span class="n">GenericCompositor</span><span class="p">(</span><span class="s">"Übersicht"</span><span class="p">)</span>
<span class="n">composite</span> <span class="o">=</span> <span class="n">compositor</span><span class="p">([</span><span class="n">scn</span><span class="p">[</span><span class="mf">3.9</span><span class="p">],</span><span class="n">scn</span><span class="p">[</span><span class="mf">10.8</span><span class="p">],</span><span class="n">scn</span><span class="p">[</span><span class="mf">12.0</span><span class="p">]])</span>
</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>That’s it.</p>

  <p>However, a composite itself is just defined as a special dataset which may have several bands (like R, G and B bands). The data isn’t stretched, or clipped or gamma filtered until an image is generated. To get an image out of the above composite, you have to convert it to an image object and tweak it’s display properties:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">img</span> <span class="o">=</span> <span class="n">satpy</span><span class="o">.</span><span class="n">writers</span><span class="o">.</span><span class="n">to_image</span><span class="p">(</span><span class="n">composite</span><span class="p">)</span>
<span class="n">img</span><span class="o">.</span><span class="n">invert</span><span class="p">([</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">])</span>
<span class="n">img</span><span class="o">.</span><span class="n">stretch</span><span class="p">(</span><span class="s">"linear"</span><span class="p">)</span>
<span class="n">img</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">img</span>
</code></pre></div></div>

<p class="output output_png"><img src="../images/units/S01E06_63_0.png" alt="png" /></p>

<div class="markdown_area ">
  <!--<div class="task ">
</div>-->

  <div class="alert task">

    <p><strong>Task:</strong></p>

    <ol>
      <li>Familiarize yourselves with SatPy’s <a href="https://satpy.readthedocs.io/en/latest/composites.html#daynightcompositor">DayNightCompositor</a></li>
      <li>Create a composite that shows microphysical information for both, day and night regions of the 06:00 UTC scene.</li>
    </ol>

  </div>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <h2 id="cropping">Cropping</h2>

  <p>Often, you are only interested in a specific region of the fulldisk.</p>

  <p>Let’s say we want to take a closer look at Greece. We can crop the fulldisk to a specific region using the <code class="highlighter-rouge">crop()</code> function of SatPy’s Scene class:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Crop to a region via lat/lon values (lon_min, lat_min, lon_max, lat_max)</span>
<span class="n">scn_cropped</span> <span class="o">=</span> <span class="n">scn</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">ll_bbox</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">))</span>
<span class="n">scn_cropped</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s">"natural_color"</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../images/units/S01E06_67_0.png" alt="png" /></p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Crop to a region via x/y values in original projection units (x_min, y_min, x_max, y_max)</span>
<span class="c"># In the case of MSG, the projection units are meters (distance from the nadir)</span>
<span class="n">scn_cropped</span> <span class="o">=</span> <span class="n">scn</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">xy_bbox</span><span class="o">=</span><span class="p">(</span><span class="mf">14E5</span><span class="p">,</span> <span class="mf">31E5</span><span class="p">,</span> <span class="mf">25E5</span><span class="p">,</span> <span class="mf">43E5</span><span class="p">))</span>
<span class="n">scn_cropped</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s">"natural_color"</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../images/units/S01E06_68_0.png" alt="png" /></p>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>The cropped scene keeps all original metadata. Only the bands, composites and coordinates/dimensions are cropped to the specified extents:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">scn_cropped</span><span class="p">[</span><span class="s">"natural_color"</span><span class="p">])</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;xarray.DataArray 'where-3d991db57e1d0ca002dc86117290e728' (bands: 3, y: 401, x: 368)&gt;
dask.array&lt;shape=(3, 401, 368), dtype=float32, chunksize=(1, 401, 368)&gt;
Coordinates:
    lat      (y, x) float32 46.407917 46.410267 ... 30.873705 30.875648
    lon      (y, x) float32 19.713308 19.759039 19.804794 ... 28.439613 28.47925
  * x        (x) float64 1.4e+06 1.403e+06 1.406e+06 ... 2.498e+06 2.501e+06
  * y        (y) float64 4.301e+06 4.298e+06 4.295e+06 ... 3.104e+06 3.101e+06
  * bands    (bands) &lt;U1 'R' 'G' 'B'
Attributes:
    standard_name:           natural_color
    file_type:               nc_seviri_l1b
    resolution:              None
    polarization:            None
    ancillary_variables:     []
    sensor:                  seviri
    valid_min:               0
    area:                    Area ID: some_area_name\nDescription: On-the-fly...
    comment:                 Radiance in mW m-2 sr-1(cm-1)-1 = add_offset + (...
    valid_max:               1023
    level:                   None
    platform_name:           Meteosat-8
    end_time:                2006-01-17 12:15:09.137000
    start_time:              2006-01-17 12:00:09.427000
    wavelength:              None
    optional_datasets:       []
    name:                    natural_color
    prerequisites:           ['IR_016', 'VIS008', 'VIS006']
    optional_prerequisites:  []
    calibration:             None
    modifiers:               None
    mode:                    RGB

</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <h2 id="resampling">Resampling</h2>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>Cropping is nice and all, but due to the satellite viewing angle, the cropped scene can look very distorted, especially when we are working with the margin regions of the scene. To get a better looking view of the domain of interest, you can use the resampling utilities of SatPy (or pyresample).</p>

  <p>To resample the data to a specific area and projection, you can specify one of the many predefined areas of SatPy. All predefined areas can be found in SatPy’s <code class="highlighter-rouge">satpy/etc/areas.yaml</code> file.</p>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>For example, let’s take libya:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">local_scn</span> <span class="o">=</span> <span class="n">scn</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s">"libya"</span><span class="p">)</span>
</code></pre></div></div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>This resamples the scene and all loaded bands/composites to the extents of the “libya” area.
If you look into the <code class="highlighter-rouge">areas.yaml</code> file, you see how it is defined:</p>

  <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>libya:
  description: libya area
  projection:
    proj: merc
    lat_ts: 31.625
    lon_0: 17.875
    ellps: WGS84
  shape:
    height: 1024
    width: 1280
  area_extent:
    lower_left_xy: [-1921632.0902750609, 1725320.2028891125]
    upper_right_xy: [1918367.9097249391, 4797320.202889113]
    units: m
</code></pre></div>  </div>

</div>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>Let’s plot the natural color composite again, to get an overview of where we are:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">local_scn</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s">"natural_color"</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../images/units/S01E06_77_0.png" alt="png" /></p>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>Nice, but let’s go back to Greece!</p>

  <p>Unfortunately, there is no predefined area definition in the yaml-File for Greece.</p>

  <p>Luckily, we can also define our own area of interest! So, let’s resample the data using the <a href="https://proj.org/operations/projections/merc.html">Mercator</a> projection:</p>

</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pyresample.geometry</span> <span class="kn">import</span> <span class="n">AreaDefinition</span>

<span class="n">area_id</span> <span class="o">=</span> <span class="s">'Griechenland'</span>
<span class="n">description</span> <span class="o">=</span> <span class="s">'Griechenland und Umgebung in Mercator-Projektion'</span>
<span class="n">proj_id</span> <span class="o">=</span> <span class="s">'Griechenland'</span>
<span class="n">proj_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s">'proj'</span><span class="p">:</span> <span class="s">'merc'</span><span class="p">,</span> <span class="s">'lat_ts'</span><span class="p">:</span> <span class="mi">38</span><span class="p">,</span> <span class="s">'lon_0'</span><span class="p">:</span> <span class="mi">25</span><span class="p">}</span>

<span class="n">width</span> <span class="o">=</span> <span class="mi">800</span>    <span class="c"># width of the result domain in pixels</span>
<span class="n">height</span> <span class="o">=</span> <span class="mi">800</span>   <span class="c"># height of the result domain in pixels</span>

<span class="n">llx</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10E5</span>   <span class="c"># projection x coordinate of lower left corner of lower left pixel</span>
<span class="n">lly</span> <span class="o">=</span>  <span class="mf">27E5</span>   <span class="c"># projection y coordinate of lower left corner of lower left pixel</span>
<span class="n">urx</span> <span class="o">=</span>  <span class="mf">10E5</span>   <span class="c"># projection x coordinate of upper right corner of upper right pixel</span>
<span class="n">ury</span> <span class="o">=</span>  <span class="mf">47E5</span>   <span class="c"># projection y coordinate of upper right corner of upper right pixel</span>

<span class="n">area_extent</span> <span class="o">=</span> <span class="p">(</span><span class="n">llx</span><span class="p">,</span><span class="n">lly</span><span class="p">,</span><span class="n">urx</span><span class="p">,</span><span class="n">ury</span><span class="p">)</span>
<span class="n">area_def</span> <span class="o">=</span> <span class="n">AreaDefinition</span><span class="p">(</span><span class="n">area_id</span><span class="p">,</span> <span class="n">proj_id</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">proj_dict</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">area_extent</span><span class="p">)</span>

<span class="n">local_scn</span> <span class="o">=</span> <span class="n">scn</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">area_def</span><span class="p">)</span>
<span class="n">local_scn</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s">"natural_color"</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../images/units/S01E06_79_0.png" alt="png" /></p>

<div class="markdown_area ">
  <!--<div class="">
</div>-->

  <p>For more information on resampling, visit the <a href="https://pyresample.readthedocs.io/en/stable/">pyresample</a> and  <a href="https://proj4.org/index.html">PROJ.4</a> documentations.</p>

</div>

<div class="markdown_area ">
  <!--<div class="task ">
</div>-->

  <div class="alert task">

    <p><strong>Task:</strong></p>

    <ol>
      <li>Crop the fulldisk to Central Europe (lat: -10 to 20, lon: 35 to 63) and plot a quicklook of the natural color composite.</li>
      <li>
        <p>Resample the fulldisk to Central Europe by defining your own area in Lambert Azimuthal Equal Area and plot a quicklook of the natural color composite. Use the following settings:</p>

        <ul>
          <li>lat and lon of origin: 49/10</li>
          <li>width and height of the resulting domain: 750px</li>
          <li>projection x/y coordinates of lower left: -18E5</li>
          <li>projection x/y coordinates of upper right: 18E5</li>
        </ul>
      </li>
    </ol>

  </div>

</div>


              <nav class="c-page__nav">
  
    
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/sommersemester_2019/units/S01E05">
      〈 <span class="u-margin-right-tiny"></span> Data science II
    </a>
  

  
    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/sommersemester_2019/solutions/solutions">
      Solutions <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

            </div>
          </div>
        </div>
      </main>
    </div>

  </body>
</html>
